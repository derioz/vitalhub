(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,43412,e=>{"use strict";var t=e.i(18050),r=e.i(71645);e.i(51718);var o=e.i(18357);e.i(36180);var a=e.i(98925),l=e.i(59141);let s=(0,r.createContext)({user:null,userData:null,loading:!0,signInWithGoogle:async()=>{},logout:async()=>{}});function n({children:e}){let[n,i]=(0,r.useState)(null),[u,c]=(0,r.useState)(null),[h,d]=(0,r.useState)(!0);(0,r.useEffect)(()=>{let e=null,t=null;return t=(0,o.onAuthStateChanged)(l.auth,async t=>{if(e&&(e(),e=null),t){i(t),d(!0);try{let r=(0,a.doc)(l.db,"users",t.uid);e=(0,a.onSnapshot)(r,e=>{if(e.exists())c(e.data());else{let e={id:t.uid,email:t.email,username:t.displayName||"Unknown",avatarUrl:t.photoURL||"",roles:["role_vital_member"],status:"ACTIVE",onboardingCompleted:!1,createdAt:(0,a.serverTimestamp)(),lastLoginAt:(0,a.serverTimestamp)()};(0,a.setDoc)(r,e).catch(console.error),c(e)}d(!1)},e=>{console.error("Firestore Snapshot Error:",e),d(!1)}),(0,a.setDoc)(r,{lastLoginAt:(0,a.serverTimestamp)()},{merge:!0}).catch(console.error)}catch(e){console.error("Auth Data Sync Error:",e),d(!1)}}else i(null),c(null),d(!1)}),()=>{t&&t(),e&&e()}},[]);let m=async()=>{let e=new o.GoogleAuthProvider;try{await (0,o.signInWithPopup)(l.auth,e)}catch(e){throw console.error("Login Failed",e),e}},g=async()=>{await (0,o.signOut)(l.auth)};return(0,t.jsx)(s.Provider,{value:{user:n,userData:u,loading:h,signInWithGoogle:m,logout:g},children:e})}e.s(["AuthProvider",()=>n,"useAuth",0,()=>(0,r.useContext)(s)])}]);